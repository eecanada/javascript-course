<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Asynchronous JavaScript</title>
  </head>
  <body>
    <h1>Asynchronous JavaScript</h1>
    <script>
      //////////////////////////////////////////////////////////////ASYNCHORNOUS JS///////////////////////////////////////////////////////////

      //     const second = () => {
      //         setTimeout(()=> {
      //             console.log('Async hey there')
      //         }, 2000)
      //     }
      //   const first = () => {
      //     console.log('Hey there')
      //     second()
      //     console.log('The End')
      //   }
      //   first()

      //////////////////////////////////////////////////////CALLBACK HELL////////////////////////////////////////////////////////////////////

      //   function getRecipe() {
      //     setTimeout(() => {
      //       const RecipeID = [523, 883, 432, 974]
      //       console.log(RecipeID)

      //       setTimeout(
      //         id => {
      //           const recipe = {
      //             title: 'Fresh Tomato Pasta',
      //             publisher: 'Eder'
      //           }
      //           console.log(`${id}: ${recipe.title}`)

      //           setTimeout(
      //             publisher => {
      //               const recipe = {
      //                 title: 'Italian Pizze',
      //                 publisher: publisher
      //               }
      //               console.log(recipe)
      //             },
      //             1500,
      //             recipe.publisher
      //           )
      //         },
      //         1000,
      //         RecipeID[2]
      //       )
      //     }, 1500)
      //   }
      //   getRecipe()

      //////////////////////////////////////////////////////////////PROMISE////////////////////////////////////////////////////////////////

      // const getIDs = new Promise((resolve,reject) => {
      //     setTimeout(() => {
      //         resolve([523, 883, 432, 974]) //resolve takes in an arguement, which is the result of the promise. This is how I return the result from the promise if it was succesful. I want to return the data in () //AKA IDS
      //     }, 1500)
      // })

      // const getRecipe = recID => { // recID is passed into the function, it think it is irrelevant name
      //     return new Promise((resolve, reject)=>{
      //         setTimeout((ID)=>{ //ID === getRecipe(IDs[2]) === 432
      //             const recipe = {
      //                 title: 'Fresh Tomato Pasta',
      //                 publisher: 'Eder'
      //             }
      //             resolve(`${ID}:${recipe.title}`) // AKA Recipe
      //         }, 1500, recID) // this recID is passed into the setTimeout function, which will then become ID
      //     })
      // }

      // const getRelated = publisher => { // publisher can be any name
      //     return new Promise((resolve,reject)=>{
      //         setTimeout((pub)=>{ // 'Eder'
      //             const recipe = {
      //                 title: 'Pizza',
      //                 publisher: 'Eder'
      //             }
      //             resolve(`${pub} ${recipe.title}`) // AKA publisher
      //         }, 1500, publisher)
      //     })
      // }

      // getIDs.then(IDs => { //IDs will be the result of the succesfull promise, [523, 883, 432, 974]
      //     console.log(IDs) // [523, 883, 432, 974]
      //     return getRecipe(IDs[2]) // this will return a promise, which is ID , IDs can be any name too
      // })
      // .then(recipe => { // recipe will be the results of the succesfull promise getRecipe
      //     console.log(recipe) // 432:Fresh Tomato Pasta
      //     return getRelated('Eder')  // this is pub
      // })
      // .then(publisher =>{ // this is the result of the promise
      //     console.log(publisher) // this is resolve()
      // })
      // .catch(error => {
      //     console.log(error)
      // })

      //////////////////////////////////////////////////////////////ASYNC & AWAIT/////////////////////////////////////////////////////////////

      // // all these are example of producing promises
      //     const getIDs = new Promise((resolve,reject)=>{
      //         setTimeout(()=> {
      //             resolve([523, 883, 432, 974]) // this is going to get returned if the promise is successful
      //         }, 1500)
      //     })

      //     const getRecipe = recID => {
      //         return new Promise((resolve,reject)=>{
      //             setTimeout((ID)=>{
      //                 const recipe = {
      //                     title: 'Fresh Tomato Pasta',
      //                     publisher: 'Eder'
      //                 }
      //                 resolve(`${ID}: ${recipe.title}`)
      //             }, 1500, recID)
      //         })
      //     }

      //     const getRelated = publisher => {
      //         return new Promise((resolve,reject)=>{
      //             setTimeout((pub)=>{
      //                 const recipe = {
      //                     title: 'Pizza',
      //                     publisher: 'Eder'
      //                 }
      //                 resolve(`${pub} ${recipe.title}`)
      //             }, 1500, publisher)
      //         })
      //     }

        //   async function getRecipesAW() {
        //       const IDs = await getIDs
        //       console.log(IDs)
        //       const recipe = await getRecipe(IDs[2])
        //       console.log(recipe)
        //       const publisher =  await getRelated('Eder')
        //       console.log(publisher)

        //       // How to return result from async with .then()
        //       return recipe // AKA   resolve(`${ID}: ${recipe.title}`)
        //   }
        //   // the argument result of the .then callback function is the resolved value of recipe, result can be anyname
        //   // I am using .then to consume the getRecipesAW promise
        //    getRecipesAW().then(result => {
        //        console.log(`${result} this is working`)
        //    })

      //////////////////////////////////////////////////////////////FETCH/////////////////////////////////////////////////////////////

    //   function getWeather(woeid) {
    //     fetch(`https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location/${woeid}/`) //fetch gets a data and return a promise
    //       .then(result => { // result is the data that came back from the fetch promise, it could have been named anything
    //         console.log(result) // result is json right now
    //         return result.json() // .json turns json to javascript, this json method returns a promise to, so I have to consume it
    //       })
    //       .then(data => {// this is consuming result.json and now I am calling that js object, data
    //         console.log(data)
    //         const today = data.consolidated_weather[0]
    //         console.log(
    //           `Temperatures in ${data.title} stay between ${today.min_temp} and ${today.max_temp} celsius`
    //         )
    //       })

    //       .catch(error => {
    //         // just used to see if there was an error
    //         console.log(error)
    //       })
    //   }
    //   getWeather(2487956) // Temperatures in San Francisco stay between 8.995000000000001 and 18.494999999999997 celsius
    //   getWeather(44418)

 //////////////////////////////////////////////////////////////ASYNC & AWAIT FETCH /////////////////////////////////////////////////////////
        
 //async function also ALWAYS returns a promise 
        async function getWeatherAW(woeid) { 
            try{ // fetch is returning a promise
                const result =  await fetch(`https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location/${woeid}/`)
            
                // json is returning a promise too
            const data = await result.json() // this is the result json that was fetched turned into json
            const today = data.consolidated_weather[0]
            // console.log(data) //the whole json object turned js object
            console.log(`Temperatures in ${data.title} stay between ${today.min_temp} and ${today.max_temp} celsius`)
                return data // what I return will be the resolved value of the promise that getWeatherAW returns
            } catch(error){
                console.log(error)
            } 
        }

       getWeatherAW(2487956) // Temperatures in San Francisco stay between 8.995000000000001 and 18.494999999999997 celsius
 
       // how to consume a promise from the async function
       // I am storing the return data which the is promise of my for getWeatherAW function london this way 
       let dataLondon;
       getWeatherAW(44418).then(data=> { // london, data can be named anything pop,dot,anything
        dataLondon = data
            console.log(dataLondon, 'test')
           })



    </script>
  </body>
</html>
